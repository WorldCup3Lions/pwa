<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Selection Results - Prop Picks</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366f1"/>
    <style>
        *{box-sizing:border-box;margin:0;padding:0}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial,sans-serif;background:linear-gradient(135deg,#0f172a 0%,#581c87 50%,#0f172a 100%);color:#fff;min-height:100vh;overflow-x:hidden;padding-bottom:100px}
        h1{font-size:22px;margin-bottom:8px}
        p.lead{color:#c4b5fd;margin-bottom:16px}
        .carousel{display:flex;overflow-x:auto;scroll-snap-type:x mandatory;gap:24px;padding:12px 0 24px 0;margin-bottom:12px}
        .card-sports{min-width:320px;max-width:340px;background:linear-gradient(135deg,#4f46e5,#7c3aed);border-radius:24px;box-shadow:0 8px 32px rgba(99,102,241,0.3);padding:24px;scroll-snap-align:center;flex-shrink:0;position:relative;transition:transform 0.2s}
        .card-sports.active{transform:scale(1.05);box-shadow:0 12px 40px rgba(16,185,129,0.2)}
        .pack-title{font-size:20px;font-weight:900;margin-bottom:8px;display:flex;align-items:center;gap:10px}
        .pack-icon{font-size:32px}
        .prop{background:rgba(255,255,255,0.08);border-radius:12px;padding:12px 14px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center}
        .prop .left{max-width:75%}
        .prop .title{font-weight:700}
        .prop .meta{color:#cbd5e1;font-size:13px}
        .points{background:rgba(251,191,36,0.12);padding:6px 10px;border-radius:8px;font-weight:800;color:#fbbf24}
        .summary{background:linear-gradient(135deg,rgba(124,58,237,0.12),transparent);padding:10px;border-radius:10px;margin-top:8px;text-align:right;font-weight:900}
        .grand-total{background:rgba(16,185,129,0.12);color:#10b981;padding:14px 0;border-radius:16px;text-align:center;font-size:20px;font-weight:900;margin-bottom:18px}
        .view-toggle{display:flex;justify-content:center;gap:12px;margin-bottom:18px}
        .toggle-btn{padding:8px 18px;border-radius:12px;border:none;cursor:pointer;font-weight:700;background:rgba(255,255,255,0.08);color:#c4b5fd;transition:background 0.2s}
        .toggle-btn.active{background:linear-gradient(135deg,#6366f1,#8b5cf6);color:#fff}
        .empty{color:#c4b5fd;padding:28px;text-align:center;border-radius:12px;background:rgba(255,255,255,0.02)}
        .list-view{margin-bottom:24px}
        .card-list{background:rgba(255,255,255,0.04);border-radius:16px;padding:18px;margin-bottom:14px}
        .btns{display:flex;gap:12px;margin-top:18px;justify-content:center}
        .btn{padding:12px 16px;border-radius:12px;border:none;cursor:pointer;font-weight:700}
        .btn.ghost{background:transparent;color:#c4b5fd;border:1px solid rgba(255,255,255,0.06)}
        .btn.primary{background:linear-gradient(135deg,#6366f1,#8b5cf6);color:white}
        .bottom-nav{position:fixed;bottom:0;left:0;right:0;background:rgba(15,23,42,0.95);backdrop-filter:blur(20px);border-top:1px solid rgba(139,92,246,0.2);padding-bottom:env(safe-area-inset-bottom,0px);z-index:1000}
        .nav-items{display:flex;justify-content:space-around;padding:12px 24px}
        .nav-item{display:flex;flex-direction:column;align-items:center;gap:4px;flex:1;cursor:pointer;transition:opacity 0.2s}
        .nav-item:active{opacity:0.6}
        .nav-icon{width:40px;height:40px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px}
        .nav-item.active .nav-icon{background:#7c3aed}
        .nav-item:not(.active){opacity:0.5}
        .nav-label{font-size:11px;font-weight:600}
    </style>
</head>
<body>
    <h1>Today's Selections</h1>
    <p class="lead">Review the props you locked in for each pack. Swipe between packs or switch to list view.</p>

    <div class="view-toggle">
        <button class="toggle-btn active" id="carouselBtn">Sports Card View</button>
        <button class="toggle-btn" id="listBtn">List View</button>
    </div>

    <div id="grandTotal" class="grand-total"></div>

    <div id="carouselView" class="carousel"></div>
    <div id="listView" class="list-view" style="display:none"></div>

    <div class="btns">
        <button class="btn ghost" id="backBtn">‚Üê Back</button>
        <button class="btn primary" id="resetBtn">Reset All</button>
    </div>

    <div class="bottom-nav">
        <div class="nav-items">
            <div class="nav-item" id="homeNav">
                <div class="nav-icon">üèÜ</div>
                <div class="nav-label">Home</div>
            </div>
            <div class="nav-item">
                <div class="nav-icon">üìä</div>
                <div class="nav-label">Stats</div>
            </div>
            <div class="nav-item active" id="resultsNav">
                <div class="nav-icon">üèÖ</div>
                <div class="nav-label">Results</div>
            </div>
            <div class="nav-item">
                <div class="nav-icon">üë§</div>
                <div class="nav-label">Profile</div>
            </div>
        </div>
    </div>

    <script>
        function renderSelections(data){
            const selections = data.selections || {};
            const packIds = ['1','2','3','4'];
            const allComplete = packIds.every(id => Array.isArray(selections[id]) && selections[id].length === 2);
            const grandTotalEl = document.getElementById('grandTotal');
            const carouselView = document.getElementById('carouselView');
            const listView = document.getElementById('listView');

            if(!allComplete){
                grandTotalEl.textContent = '';
                carouselView.innerHTML = '<div class="empty">You have not completed all packs yet.<br>Complete all 4 packs to view your final selections.</div>';
                listView.innerHTML = '';
                return;
            }

            let totalPoints = 0;
            carouselView.innerHTML = '';
            listView.innerHTML = '';

            packIds.forEach((id, idx) => {
                const pack = selections[id];
                const packTotal = (pack[0].points || 0) + (pack[1].points || 0);
                totalPoints += packTotal;

                // Sports card (carousel)
                const card = document.createElement('div');
                card.className = 'card-sports';
                card.innerHTML = `
                    <div class="pack-title"><span class="pack-icon">üì¶</span>Pack #${id}</div>
                    <div class="prop">
                        <div class="left">
                            <div class="title">${pack[0].text || pack[0].label || 'Unknown Pick'}</div>
                            <div class="meta">${pack[0].game || ''}</div>
                        </div>
                        <div class="points">${pack[0].points || 0} pts</div>
                    </div>
                    <div class="prop">
                        <div class="left">
                            <div class="title">${pack[1].text || pack[1].label || 'Unknown Pick'}</div>
                            <div class="meta">${pack[1].game || ''}</div>
                        </div>
                        <div class="points">${pack[1].points || 0} pts</div>
                    </div>
                    <div class="summary">Pack total: ${packTotal} pts</div>
                `;
                carouselView.appendChild(card);

                // List view
                const listCard = document.createElement('div');
                listCard.className = 'card-list';
                listCard.innerHTML = `
                    <div class="pack-title"><span class="pack-icon">üì¶</span>Pack #${id}</div>
                    <div class="prop">
                        <div class="left">
                            <div class="title">${pack[0].text || pack[0].label || 'Unknown Pick'}</div>
                            <div class="meta">${pack[0].game || ''}</div>
                        </div>
                        <div class="points">${pack[0].points || 0} pts</div>
                    </div>
                    <div class="prop">
                        <div class="left">
                            <div class="title">${pack[1].text || pack[1].label || 'Unknown Pick'}</div>
                            <div class="meta">${pack[1].game || ''}</div>
                        </div>
                        <div class="points">${pack[1].points || 0} pts</div>
                    </div>
                    <div class="summary">Pack total: ${packTotal} pts</div>
                `;
                listView.appendChild(listCard);
            });

            grandTotalEl.textContent = `Grand Total: ${totalPoints} pts`;
        }

        // Toggle view
        document.getElementById('carouselBtn').addEventListener('click', function(){
            this.classList.add('active');
            document.getElementById('listBtn').classList.remove('active');
            document.getElementById('carouselView').style.display = '';
            document.getElementById('listView').style.display = 'none';
        });
        document.getElementById('listBtn').addEventListener('click', function(){
            this.classList.add('active');
            document.getElementById('carouselBtn').classList.remove('active');
            document.getElementById('carouselView').style.display = 'none';
            document.getElementById('listView').style.display = '';
        });

        document.getElementById('backBtn').addEventListener('click', ()=>{window.location.href='index.html'});
        document.getElementById('resetBtn').addEventListener('click', ()=>{
            if(confirm('Reset all picks? This cannot be undone.')){
                localStorage.removeItem('propPicksData');
                localStorage.setItem('lastResetDate', new Date().toDateString());
                window.location.href = 'index.html';
            }
        });

        // Bottom nav actions
        document.getElementById('homeNav').addEventListener('click', ()=>{window.location.href='index.html'});
        document.getElementById('resultsNav').addEventListener('click', ()=>{window.location.href='selection.html'});

        // Load data and render
        (function(){
            try{
                const data = JSON.parse(localStorage.getItem('propPicksData') || '{}');
                renderSelections(data);
            }catch(e){
                document.getElementById('carouselView').textContent = 'Error loading selections.';
                console.error(e);
            }
        })();
    </script>
</body>
</html>

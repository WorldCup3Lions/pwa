<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Open Pack - Prop Picks</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366f1"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #581c87 50%, #0f172a 100%);
            color: white;
            min-height: 100vh;
            -webkit-tap-highlight-color: transparent;
        }
        
        .status-bar {
            height: env(safe-area-inset-top, 44px);
            background: transparent;
        }
        
        .header {
            padding: 16px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .back-btn {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            color: white;
            font-size: 24px;
        }
        
        .back-btn:active {
            background: rgba(255,255,255,0.2);
        }
        
        .selection-counter {
            text-align: center;
        }
        
        .counter-label {
            font-size: 12px;
            color: #c4b5fd;
            margin-bottom: 4px;
        }
        
        .counter-value {
            font-size: 24px;
            font-weight: 900;
        }
        
        .pack-title {
            text-align: center;
            padding: 0 24px 24px;
        }
        
        .pack-badge {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            padding: 16px 32px;
            border-radius: 20px;
            margin-bottom: 12px;
        }
        
        .pack-icon {
            font-size: 32px;
        }
        
        .pack-name {
            font-size: 24px;
            font-weight: 900;
        }
        
        .pack-subtitle {
            font-size: 14px;
            color: #c4b5fd;
        }
        
        /* Pack Opening Screen */
        .pack-opening-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 24px;
        }
        
        .pack-opening-screen.hidden {
            display: none;
        }
        
        .pack-visual {
            width: 200px;
            height: 280px;
            cursor: pointer;
            transition: transform 0.2s;
            position: relative;
        }
        
        .pack-visual img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: block;
        }
        
        .pack-visual:active {
            transform: scale(0.95);
        }
        
        .pack-visual.shake {
            animation: shake 0.5s;
        }
        
        @keyframes shake {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg) scale(1.05); }
            75% { transform: rotate(10deg) scale(1.05); }
        }
        
        .pack-visual.opening {
            animation: openPack 1.2s forwards;
        }
        
        @keyframes openPack {
            0% { 
                transform: scale(1) rotateY(0deg) rotateZ(0deg); 
                opacity: 1;
                filter: brightness(1);
            }
            15% { 
                transform: scale(1.15) rotateY(0deg) rotateZ(5deg); 
            }
            30% { 
                transform: scale(1.3) rotateY(20deg) rotateZ(-5deg); 
                filter: brightness(1.3);
            }
            50% { 
                transform: scale(1.5) rotateY(90deg) rotateZ(0deg); 
                opacity: 0.8;
                filter: brightness(1.5) blur(2px);
            }
            70% {
                transform: scale(1.2) rotateY(180deg) rotateZ(10deg);
                opacity: 0.4;
                filter: brightness(2) blur(4px);
            }
            100% { 
                transform: scale(0.5) rotateY(270deg) rotateZ(0deg); 
                opacity: 0;
                filter: brightness(3) blur(8px);
            }
        }
        
        .pack-opening-screen::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(139, 92, 246, 0.3), transparent);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .pack-opening-screen.opening::before {
            animation: glowPulse 1.2s forwards;
        }
        
        @keyframes glowPulse {
            0%, 100% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.5); }
        }
        
        @keyframes quickFadeOut {
            0% { 
                opacity: 1; 
                transform: scale(1);
            }
            100% { 
                opacity: 0; 
                transform: scale(0.9);
            }
        }
        
        .tap-indicator {
            margin-top: 32px;
            font-size: 18px;
            font-weight: 600;
            color: #c4b5fd;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .tap-count {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            justify-content: center;
        }
        
        .tap-dot {
            width: 16px;
            height: 16px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .tap-dot.active {
            background: #10b981;
            transform: scale(1.3);
        }
        
        /* Cards Section */
        .cards-section {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }
        
        .cards-section.visible {
            opacity: 1;
            pointer-events: all;
        }
        
        .cards-container {
            padding: 0 24px;
            padding-bottom: calc(100px + env(safe-area-inset-bottom, 0px));
        }
        
        .card {
            background: rgba(30, 27, 75, 0.6);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: background 0.2s, border-color 0.2s, box-shadow 0.2s, opacity 0.2s;
        }
        
        .card.initial-appear {
            opacity: 0;
            animation: cardAppear 0.5s forwards;
        }
        
        @keyframes cardAppear {
            to {
                opacity: 1;
            }
        }
        
        .card:active {
            opacity: 0.9;
        }
        
        .card.selected {
            background: linear-gradient(135deg, #059669, #10b981);
            border-color: rgba(16, 185, 129, 0.5);
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.4);
        }
        
        .card.disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }
        
        .card-text {
            font-size: 16px;
            font-weight: 600;
            flex: 1;
            padding-right: 12px;
        }
        
        .checkmark {
            width: 28px;
            height: 28px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #059669;
            flex-shrink: 0;
        }
        
        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-game {
            font-size: 12px;
            color: #94a3b8;
        }
        
        .card.selected .card-game {
            color: rgba(255,255,255,0.8);
        }
        
        .card-points {
            background: rgba(251, 191, 36, 0.2);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 700;
            color: #fbbf24;
        }
        
        .card.selected .card-points {
            background: rgba(255,255,255,0.2);
            color: white;
        }
        
        .lock-button {
            position: fixed;
            bottom: env(safe-area-inset-bottom, 20px);
            left: 24px;
            right: 24px;
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 900;
            cursor: pointer;
            box-shadow: 0 8px 32px rgba(16, 185, 129, 0.4);
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s;
        }
        
        .lock-button.visible {
            opacity: 1;
            pointer-events: all;
        }
        
        .lock-button:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <div class="status-bar"></div>
    
    <!-- Pack Opening Screen -->
    <div class="pack-opening-screen" id="packOpeningScreen">
        <div class="pack-visual" id="packVisual" onclick="tapPack()">
            <img src="icon-400x560.png" alt="Pack">
        </div>
        <div class="tap-indicator">
            <div>Tap to open pack!</div>
            <div class="tap-count">
                <div class="tap-dot" id="tap1"></div>
                <div class="tap-dot" id="tap2"></div>
                <div class="tap-dot" id="tap3"></div>
            </div>
        </div>
    </div>
    
    <!-- Cards Section (hidden initially) -->
    <div class="cards-section" id="cardsSection">
        <div class="header">
            <button class="back-btn" onclick="goBack()">‚Üê</button>
            <div class="selection-counter">
                <div class="counter-label">Selected</div>
                <div class="counter-value"><span id="selectedCount">0</span>/2</div>
            </div>
            <div style="width: 40px;"></div>
        </div>
        
        <div class="pack-title">
            <div class="pack-badge">
                <span class="pack-icon">üì¶</span>
                <span class="pack-name" id="packName">Pack #1</span>
            </div>
            <p class="pack-subtitle">Choose 2 props to lock in</p>
        </div>
        
        <div class="cards-container" id="cardsContainer">
            <!-- Cards will be dynamically inserted here -->
        </div>
        
        <button class="lock-button" id="lockButton" onclick="lockInPicks()">
            üîí Lock In Picks
        </button>
    </div>
    
    <script>
        // 80 unique props
        const allProps = [
            { id: 1, text: 'Mahomes Over 275.5 Pass Yds', points: 150, game: 'JAX vs KC' },
            { id: 2, text: 'Chiefs -7.5', points: 75, game: 'JAX vs KC' },
            { id: 3, text: 'Travis Kelce Over 65.5 Rec Yds', points: 100, game: 'JAX vs KC' },
            { id: 4, text: 'Lawrence Over 1.5 Pass TDs', points: 125, game: 'JAX vs KC' },
            { id: 5, text: 'Over 47.5 Total Points', points: 50, game: 'JAX vs KC' },
            { id: 6, text: 'Etienne Over 75.5 Rush Yds', points: 175, game: 'JAX vs KC' },
            { id: 7, text: 'Mahomes 2+ Pass TDs', points: 75, game: 'JAX vs KC' },
            { id: 8, text: 'Jaguars ML', points: 300, game: 'JAX vs KC' },
            { id: 9, text: 'Under 47.5 Total Points', points: 50, game: 'JAX vs KC' },
            { id: 10, text: 'Chiefs Win 1st Half', points: 100, game: 'JAX vs KC' },
            { id: 11, text: 'Rice Over 55.5 Rec Yds', points: 125, game: 'JAX vs KC' },
            { id: 12, text: 'Kirk Over 4.5 Receptions', points: 80, game: 'JAX vs KC' },
            { id: 13, text: 'Pacheco Over 65.5 Rush Yds', points: 150, game: 'JAX vs KC' },
            { id: 14, text: 'Lawrence Over 250.5 Pass Yds', points: 100, game: 'JAX vs KC' },
            { id: 15, text: 'Chiefs Score 1st TD', points: 60, game: 'JAX vs KC' },
            { id: 16, text: 'Game Total Odd', points: 125, game: 'JAX vs KC' },
            { id: 17, text: 'Any TD in Final 2 Min', points: 200, game: 'JAX vs KC' },
            { id: 18, text: 'Chiefs Win By 14+', points: 225, game: 'JAX vs KC' },
            { id: 19, text: 'Successful 2pt Conversion', points: 250, game: 'JAX vs KC' },
            { id: 20, text: 'Kelce Anytime TD', points: 175, game: 'JAX vs KC' },
            { id: 21, text: 'Allen Over 285.5 Pass Yds', points: 140, game: 'BUF vs MIA' },
            { id: 22, text: 'Bills -3.5', points: 80, game: 'BUF vs MIA' },
            { id: 23, text: 'Diggs Over 75.5 Rec Yds', points: 110, game: 'BUF vs MIA' },
            { id: 24, text: 'Tua Over 2.5 Pass TDs', points: 135, game: 'BUF vs MIA' },
            { id: 25, text: 'Over 51.5 Total Points', points: 55, game: 'BUF vs MIA' },
            { id: 26, text: 'Mostert Over 55.5 Rush Yds', points: 165, game: 'BUF vs MIA' },
            { id: 27, text: 'Allen 3+ Pass TDs', points: 85, game: 'BUF vs MIA' },
            { id: 28, text: 'Dolphins ML', points: 275, game: 'BUF vs MIA' },
            { id: 29, text: 'Under 51.5 Total Points', points: 55, game: 'BUF vs MIA' },
            { id: 30, text: 'Bills Win 1st Half', points: 95, game: 'BUF vs MIA' },
            { id: 31, text: 'Hill Over 85.5 Rec Yds', points: 130, game: 'BUF vs MIA' },
            { id: 32, text: 'Waddle Over 5.5 Receptions', points: 75, game: 'BUF vs MIA' },
            { id: 33, text: 'Cook Over 70.5 Rush Yds', points: 145, game: 'BUF vs MIA' },
            { id: 34, text: 'Tua Over 265.5 Pass Yds', points: 105, game: 'BUF vs MIA' },
            { id: 35, text: 'Dolphins Score 1st TD', points: 65, game: 'BUF vs MIA' },
            { id: 36, text: 'Game Total Even', points: 120, game: 'BUF vs MIA' },
            { id: 37, text: 'Any Turnover 1st Quarter', points: 190, game: 'BUF vs MIA' },
            { id: 38, text: 'Bills Win By 10+', points: 210, game: 'BUF vs MIA' },
            { id: 39, text: 'FG Made 50+ Yards', points: 240, game: 'BUF vs MIA' },
            { id: 40, text: 'Hill Anytime TD', points: 160, game: 'BUF vs MIA' },
            { id: 41, text: 'Hurts Over 225.5 Pass Yds', points: 155, game: 'PHI vs DAL' },
            { id: 42, text: 'Eagles -4.5', points: 70, game: 'PHI vs DAL' },
            { id: 43, text: 'Brown Over 70.5 Rec Yds', points: 115, game: 'PHI vs DAL' },
            { id: 44, text: 'Prescott Over 2.5 Pass TDs', points: 130, game: 'PHI vs DAL' },
            { id: 45, text: 'Over 49.5 Total Points', points: 60, game: 'PHI vs DAL' },
            { id: 46, text: 'Pollard Over 65.5 Rush Yds', points: 170, game: 'PHI vs DAL' },
            { id: 47, text: 'Hurts 2+ Rush TDs', points: 200, game: 'PHI vs DAL' },
            { id: 48, text: 'Cowboys ML', points: 280, game: 'PHI vs DAL' },
            { id: 49, text: 'Under 49.5 Total Points', points: 60, game: 'PHI vs DAL' },
            { id: 50, text: 'Eagles Win 1st Half', points: 90, game: 'PHI vs DAL' },
            { id: 51, text: 'Smith Over 60.5 Rec Yds', points: 135, game: 'PHI vs DAL' },
            { id: 52, text: 'Lamb Over 6.5 Receptions', points: 85, game: 'PHI vs DAL' },
            { id: 53, text: 'Swift Over 55.5 Rush Yds', points: 140, game: 'PHI vs DAL' },
            { id: 54, text: 'Prescott Over 280.5 Pass Yds', points: 110, game: 'PHI vs DAL' },
            { id: 55, text: 'Cowboys Score 1st TD', points: 70, game: 'PHI vs DAL' },
            { id: 56, text: 'Defensive TD Scored', points: 300, game: 'PHI vs DAL' },
            { id: 57, text: 'Sack in Final 5 Min', points: 180, game: 'PHI vs DAL' },
            { id: 58, text: 'Eagles Win By 7+', points: 195, game: 'PHI vs DAL' },
            { id: 59, text: 'Game Goes to OT', points: 500, game: 'PHI vs DAL' },
            { id: 60, text: 'Brown Anytime TD', points: 170, game: 'PHI vs DAL' },
            { id: 61, text: 'Purdy Over 245.5 Pass Yds', points: 145, game: 'SF vs SEA' },
            { id: 62, text: '49ers -6.5', points: 85, game: 'SF vs SEA' },
            { id: 63, text: 'Deebo Over 65.5 Rec Yds', points: 120, game: 'SF vs SEA' },
            { id: 64, text: 'Geno Over 1.5 Pass TDs', points: 115, game: 'SF vs SEA' },
            { id: 65, text: 'Over 45.5 Total Points', points: 65, game: 'SF vs SEA' },
            { id: 66, text: 'McCaffrey Over 85.5 Rush Yds', points: 185, game: 'SF vs SEA' },
            { id: 67, text: 'Purdy 3+ Pass TDs', points: 95, game: 'SF vs SEA' },
            { id: 68, text: 'Seahawks ML', points: 290, game: 'SF vs SEA' },
            { id: 69, text: 'Under 45.5 Total Points', points: 65, game: 'SF vs SEA' },
            { id: 70, text: '49ers Win 1st Half', points: 105, game: 'SF vs SEA' },
            { id: 71, text: 'Aiyuk Over 70.5 Rec Yds', points: 140, game: 'SF vs SEA' },
            { id: 72, text: 'Metcalf Over 5.5 Receptions', points: 90, game: 'SF vs SEA' },
            { id: 73, text: 'Walker Over 60.5 Rush Yds', points: 160, game: 'SF vs SEA' },
            { id: 74, text: 'Geno Over 255.5 Pass Yds', points: 125, game: 'SF vs SEA' },
            { id: 75, text: 'Seahawks Score 1st TD', points: 75, game: 'SF vs SEA' },
            { id: 76, text: 'Longest TD Over 45.5 Yds', points: 215, game: 'SF vs SEA' },
            { id: 77, text: 'Interception Thrown', points: 150, game: 'SF vs SEA' },
            { id: 78, text: '49ers Win By 14+', points: 235, game: 'SF vs SEA' },
            { id: 79, text: 'Safety Scored', points: 600, game: 'SF vs SEA' },
            { id: 80, text: 'McCaffrey Anytime TD', points: 165, game: 'SF vs SEA' }
        ];
        
        let selectedCards = [];
        let currentPackId = null;
        let packCards = [];
        let tapCount = 0;
        let isPackOpened = false;
        
        // Initialize page
        function init() {
            currentPackId = localStorage.getItem('currentPack') || '1';
            document.getElementById('packName').textContent = `Pack #${currentPackId}`;
            
            // Load existing selections if any
            const data = JSON.parse(localStorage.getItem('propPicksData') || '{}');
            const selections = data.selections || {};
            const openedPacks = data.openedPacks || [];
            selectedCards = selections[currentPackId] || [];
            
            // Get cards for this pack (ensuring no duplicates)
            packCards = getPackCards(currentPackId);
            
            // Check if pack has been opened before
            if (openedPacks.includes(currentPackId)) {
                // Pack was opened before - show quick fade animation
                isPackOpened = true;
                const packVisual = document.getElementById('packVisual');
                const packOpeningScreen = document.getElementById('packOpeningScreen');
                const cardsSection = document.getElementById('cardsSection');
                
                // Add fade out class
                packVisual.style.animation = 'quickFadeOut 0.6s forwards';
                
                setTimeout(() => {
                    packOpeningScreen.classList.add('hidden');
                    cardsSection.classList.add('visible');
                    renderCards();
                    updateUI();
                }, 600);
            }
        }
        
        // Seeded random function for consistent pack generation per session
        function seededRandom(seed) {
            const x = Math.sin(seed) * 10000;
            return x - Math.floor(x);
        }
        
        // Generate a unique session seed based on device and reset time
        function getSessionSeed() {
            let sessionSeed = localStorage.getItem('sessionSeed');
            const lastResetDate = localStorage.getItem('lastResetDate');
            const today = new Date().toDateString();
            
            // If no session seed exists or it's a new day, generate a new one
            if (!sessionSeed || lastResetDate !== today) {
                // Create a random seed unique to this device and session
                sessionSeed = Math.floor(Math.random() * 1000000).toString();
                localStorage.setItem('sessionSeed', sessionSeed);
                localStorage.setItem('lastResetDate', today);
            }
            
            return parseInt(sessionSeed);
        }
        
        // Get 5 unique random cards for a pack
        function getPackCards(packId) {
            const sessionSeed = getSessionSeed();
            const seed = sessionSeed + (parseInt(packId) * 12345); // Unique seed per pack within session
            const availableProps = [...allProps];
            
            // Fisher-Yates shuffle with seeded random
            for (let i = availableProps.length - 1; i > 0; i--) {
                const j = Math.floor(seededRandom(seed + i) * (i + 1));
                [availableProps[i], availableProps[j]] = [availableProps[j], availableProps[i]];
            }
            
            // Take first 5 cards
            return availableProps.slice(0, 5);
        }
        
        // Handle pack tapping
        function tapPack() {
            if (isPackOpened) return;
            
            tapCount++;
            const packVisual = document.getElementById('packVisual');
            const tapDot = document.getElementById(`tap${tapCount}`);
            
            if (tapDot) {
                tapDot.classList.add('active');
            }
            
            packVisual.classList.add('shake');
            setTimeout(() => packVisual.classList.remove('shake'), 500);
            
            if (tapCount >= 3) {
                openPack();
            }
        }
        
        // Open the pack with animation
        function openPack() {
            isPackOpened = true;
            const packVisual = document.getElementById('packVisual');
            const packOpeningScreen = document.getElementById('packOpeningScreen');
            const cardsSection = document.getElementById('cardsSection');
            
            packVisual.classList.add('opening');
            packOpeningScreen.classList.add('opening');
            
            // Mark this pack as opened
            const data = JSON.parse(localStorage.getItem('propPicksData') || '{}');
            if (!data.openedPacks) data.openedPacks = [];
            if (!data.openedPacks.includes(currentPackId)) {
                data.openedPacks.push(currentPackId);
                localStorage.setItem('propPicksData', JSON.stringify(data));
            }
            
            setTimeout(() => {
                packOpeningScreen.classList.add('hidden');
                cardsSection.classList.add('visible');
                renderCards();
                updateUI();
            }, 1200);
        }
        
        // Render all cards with staggered animation (only on initial load)
        function renderCards() {
            const container = document.getElementById('cardsContainer');
            container.innerHTML = '';
            
            packCards.forEach((card, index) => {
                const isSelected = selectedCards.some(c => c.id === card.id);
                const isDisabled = selectedCards.length >= 2 && !isSelected;
                
                const cardEl = document.createElement('div');
                cardEl.className = `card initial-appear ${isSelected ? 'selected' : ''} ${isDisabled ? 'disabled' : ''}`;
                cardEl.style.animationDelay = `${index * 0.1}s`;
                cardEl.onclick = () => !isDisabled && toggleCard(card);
                
                cardEl.innerHTML = `
                    <div class="card-header">
                        <div class="card-text">${card.text}</div>
                        ${isSelected ? '<div class="checkmark">‚úì</div>' : ''}
                    </div>
                    <div class="card-footer">
                        <div class="card-game">${card.game}</div>
                        <div class="card-points">${card.points} pts</div>
                    </div>
                `;
                
                container.appendChild(cardEl);
            });
        }
        
        // Toggle card selection
        function toggleCard(card) {
            const index = selectedCards.findIndex(c => c.id === card.id);
            
            if (index > -1) {
                selectedCards.splice(index, 1);
            } else if (selectedCards.length < 2) {
                selectedCards.push(card);
            }
            
            updateCardsState();
            updateUI();
        }
        
        // Update card states without re-rendering (no blinking)
        function updateCardsState() {
            const container = document.getElementById('cardsContainer');
            const cardElements = container.querySelectorAll('.card');
            
            cardElements.forEach((cardEl, index) => {
                const card = packCards[index];
                const isSelected = selectedCards.some(c => c.id === card.id);
                const isDisabled = selectedCards.length >= 2 && !isSelected;
                
                // Update classes
                if (isSelected) {
                    cardEl.classList.add('selected');
                } else {
                    cardEl.classList.remove('selected');
                }
                
                if (isDisabled) {
                    cardEl.classList.add('disabled');
                } else {
                    cardEl.classList.remove('disabled');
                }
                
                // Update checkmark
                const header = cardEl.querySelector('.card-header');
                const existingCheckmark = header.querySelector('.checkmark');
                
                if (isSelected && !existingCheckmark) {
                    const checkmark = document.createElement('div');
                    checkmark.className = 'checkmark';
                    checkmark.textContent = '‚úì';
                    header.appendChild(checkmark);
                } else if (!isSelected && existingCheckmark) {
                    existingCheckmark.remove();
                }
            });
        }
        
        // Update UI (counter and button)
        function updateUI() {
            document.getElementById('selectedCount').textContent = selectedCards.length;
            
            const lockButton = document.getElementById('lockButton');
            if (selectedCards.length === 2) {
                lockButton.classList.add('visible');
            } else {
                lockButton.classList.remove('visible');
            }
        }
        
        // Lock in picks and save
        function lockInPicks() {
            if (selectedCards.length !== 2) return;
            
            const data = JSON.parse(localStorage.getItem('propPicksData') || '{}');
            if (!data.selections) data.selections = {};
            
            data.selections[currentPackId] = selectedCards;
            localStorage.setItem('propPicksData', JSON.stringify(data));
            
            window.location.href = 'index.html';
        }
        
        // Go back without saving
        function goBack() {
            window.location.href = 'index.html';
        }
        
        // Initialize on load
        init();
    </script>
</body>
</html>
